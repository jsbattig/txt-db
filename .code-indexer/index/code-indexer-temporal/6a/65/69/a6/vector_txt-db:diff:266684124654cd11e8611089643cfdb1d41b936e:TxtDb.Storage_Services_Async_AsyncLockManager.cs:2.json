{
  "id": "txt-db:diff:266684124654cd11e8611089643cfdb1d41b936e:TxtDb.Storage/Services/Async/AsyncLockManager.cs:2",
  "vector": [
    0.035171527,
    -0.00323636,
    0.005007647,
    0.026502158,
    0.023774613,
    0.007845505,
    -0.009266282,
    -0.01735777,
    0.047567703,
    0.004371376,
    -0.02586785,
    0.004131189,
    0.06128145,
    -0.031275805,
    -0.015149854,
    -0.045979515,
    0.078091614,
    0.019995157,
    -0.017473437,
    -0.010128161,
    -0.05496759,
    -0.073230259,
    -0.057705522,
    0.048238933,
    -0.034244981,
    -0.00091027,
    0.038759526,
    0.0373974,
    -0.004255495,
    0.055811841,
    0.023004722,
    -0.04449892,
    0.000874395,
    0.014384925,
    0.033962384,
    -0.029927621,
    -0.048878726,
    0.007485387,
    -0.017544284,
    -0.027862081,
    0.045991573,
    0.023354378,
    0.051020008,
    -0.03042567,
    0.048797607,
    -0.067275263,
    0.030525835,
    -0.017650554,
    0.008306134,
    -0.011042528,
    0.003173679,
    -0.005673155,
    -0.016925532,
    0.037861638,
    -0.012054694,
    -0.00116352,
    0.043679513,
    0.021491883,
    -0.051505562,
    0.015033615,
    -0.009299365,
    -0.000466351,
    -0.007637802,
    0.025044747,
    -0.035984226,
    -0.020023337,
    -0.043535993,
    0.052725583,
    -0.01415104,
    -0.082133956,
    0.032844517,
    0.023410404,
    -0.005299852,
    0.016060181,
    -0.027849918,
    0.047245789,
    0.013487066,
    -0.003558647,
    0.033671301,
    -0.006004898,
    -0.048568066,
    -0.035972722,
    0.012940063,
    0.029194683,
    0.07478103,
    0.021484708,
    0.018542385,
    -0.025194008,
    0.020905571,
    0.018297523,
    -0.012206269,
    -0.006303431,
    0.005957351,
    0.019548886,
    0.029112538,
    -0.026608124,
    0.005778215,
    0.052142363,
    0.016741574,
    -0.06299115,
    0.015214244,
    0.054455221,
    -0.054735478,
    0.01279599,
    -0.051032353,
    -0.003678578,
    -0.031531423,
    -0.020859219,
    0.015021044,
    0.027271032,
    0.026712148,
    0.02199452,
    -0.010743593,
    -0.007060313,
    0.023371635,
    -0.034077805,
    0.013534009,
    -0.003423646,
    -0.026940651,
    0.027728828,
    -0.002104902,
    0.026985483,
    -0.053122785,
    0.055133257,
    -0.055215772,
    0.023732889,
    0.011868472,
    0.022792427,
    0.017281871,
    -0.045731727,
    0.020234821,
    -0.027639512,
    0.012713063,
    0.000819772,
    0.019804209,
    0.021452488,
    0.020336971,
    0.012976231,
    0.039343942,
    -0.042420577,
    0.02859539,
    -0.030381056,
    -0.023950772,
    -0.016991628,
    -0.00640235,
    -0.020705862,
    0.04123025,
    -0.007444633,
    -0.016793836,
    -0.037723981,
    0.03748294,
    0.076129451,
    -0.030528085,
    0.043230534,
    -0.029264174,
    0.065620102,
    -0.054590464,
    -0.021408586,
    -0.022121063,
    0.021362917,
    -0.013446243,
    0.026980706,
    -0.017061815,
    -0.003355015,
    -0.04412001,
    0.05328818,
    0.008930653,
    -0.014789459,
    0.016665883,
    -0.008637018,
    -0.046380617,
    0.012364447,
    -0.076085344,
    0.002028555,
    0.027903888,
    0.048983388,
    -0.012468839,
    0.024123179,
    -0.046945456,
    0.021815922,
    0.055527609,
    -0.053978942,
    0.006401617,
    -0.055880651,
    0.03680028,
    -0.002188806,
    0.060091387,
    0.03590624,
    -0.024523465,
    -0.021659346,
    -0.031764522,
    -0.002394776,
    -0.049248923,
    -0.009461921,
    -0.006210586,
    -0.011634973,
    -0.083633959,
    0.016647372,
    0.049861867,
    0.013653441,
    5.4094e-05,
    0.023726191,
    -0.029762689,
    -0.028287319,
    0.004094647,
    0.033099677,
    -0.052052006,
    0.011268018,
    0.012986979,
    -0.03110268,
    0.000766069,
    0.027958209,
    -0.032597899,
    0.015545939,
    -0.011846756,
    0.001752901,
    -0.017579712,
    -0.00782428,
    0.035303961,
    0.011818054,
    -0.009891326,
    0.01154588,
    0.052526027,
    0.015555114,
    -0.001722157,
    -0.048548456,
    -0.060298309,
    -0.037154712,
    -0.015478125,
    -0.058237337,
    -0.027209235,
    -0.062320124,
    0.044435687,
    -0.041280273,
    -0.016914649,
    0.018130291,
    -0.01517095,
    0.010450169,
    0.000591639,
    -0.001208168,
    -0.013700917,
    0.012457551,
    0.041554164,
    0.004776385,
    -0.065422907,
    -0.030895798,
    0.053988248,
    -0.019067263,
    0.049645294,
    0.021660315,
    -0.013796043,
    0.002234214,
    -0.030853687,
    0.027075781,
    -0.007413524,
    -0.019607652,
    0.017738739,
    -0.049673602,
    0.010601284,
    -0.008053277,
    0.013887744,
    0.04374928,
    -0.042956728,
    0.046794616,
    -0.010695109,
    0.009456848,
    -0.058112074,
    -0.019043744,
    -0.024107693,
    -0.010385101,
    0.007563206,
    -0.009055979,
    0.014315159,
    0.016329171,
    0.04212239,
    -0.027839955,
    -0.003316738,
    -0.001394244,
    -0.014688756,
    -0.000758196,
    -0.023508664,
    -0.013869874,
    0.041229207,
    -0.023945302,
    -0.045946918,
    -0.024854125,
    -0.018025657,
    -0.007390746,
    0.023814928,
    0.023659613,
    0.025437752,
    -0.02797232,
    -0.022177337,
    -0.035196856,
    0.034757946,
    0.056627437,
    0.045575213,
    0.016787136,
    0.047859415,
    -0.053749945,
    -0.021128746,
    0.009437023,
    0.073142305,
    0.037114326,
    -0.010743375,
    -0.009872934,
    0.021232679,
    -0.020766499,
    0.020337915,
    -0.026173184,
    -0.01268012,
    -0.01433145,
    -0.021572949,
    -0.013421505,
    -0.009059009,
    -0.069950841,
    -0.033721004,
    0.010627813,
    -0.025864437,
    -0.006107414,
    0.041949011,
    -0.006522478,
    -0.008038316,
    -0.034749784,
    0.002369317,
    0.049419791,
    -0.049094118,
    -0.055755328,
    0.098760583,
    -0.03658995,
    -0.019479148,
    0.001162102,
    -0.02273508,
    0.031951621,
    -0.021604361,
    0.013775541,
    -0.03928183,
    -0.011342276,
    -0.022429902,
    0.035402361,
    0.007700881,
    0.004755268,
    0.028442262,
    0.034518167,
    0.053529501,
    -0.010032889,
    0.037751954,
    -0.017298454,
    -0.004705786,
    0.049696028,
    0.001124779,
    -0.030412382,
    -0.002914967,
    -0.003240497,
    -0.055655375,
    0.041084282,
    -0.014129119,
    -0.005115342,
    -0.021860983,
    0.025561469,
    -0.024967672,
    -0.004626733,
    -0.024151322,
    -0.006585668,
    -0.012116777,
    0.028971734,
    -0.035103261,
    0.059379417,
    -0.04689154,
    0.041500244,
    -0.032317437,
    -0.044989996,
    -0.064618245,
    0.002030892,
    0.025335388,
    0.030463118,
    0.059781458,
    -0.013487453,
    0.010035389,
    -0.051797345,
    -0.017778197,
    -0.004442456,
    -0.004019232,
    0.000857316,
    0.001189961,
    -0.026755322,
    0.012465576,
    0.021314271,
    -0.011203096,
    0.031646151,
    0.029081132,
    0.012151792,
    -0.019033557,
    0.000594166,
    -0.038790733,
    -0.035768636,
    0.013578715,
    0.00438989,
    0.037564769,
    -0.006395902,
    0.01954473,
    -0.015811885,
    0.060321059,
    -0.025412267,
    0.075675927,
    0.00921923,
    -0.007392257,
    0.013272671,
    -0.037907179,
    0.009133426,
    -0.002084974,
    0.053063475,
    -0.008868533,
    0.048864316,
    -0.022361793,
    0.061965466,
    -0.021659227,
    -0.007079804,
    -0.014049285,
    -0.016362604,
    -0.016820153,
    -0.008155446,
    -0.021072237,
    -0.053814404,
    -0.047231287,
    -0.009807811,
    0.038506247,
    -0.063129254,
    0.00210235,
    0.026609592,
    -0.013602854,
    -0.015743515,
    -0.079380631,
    0.006724125,
    0.016192425,
    -0.061507281,
    -0.016836412,
    -0.026033875,
    -0.003889922,
    0.003783446,
    -0.027270086,
    -0.02599979,
    0.070069276,
    -0.041185338,
    0.011306619,
    -0.029436806,
    0.010318962,
    0.067679673,
    0.004170617,
    -0.01915326,
    -0.055044103,
    -0.000411117,
    -0.050955389,
    0.002444165,
    0.027222656,
    -0.032517426,
    -0.041854687,
    0.038764764,
    -0.006331752,
    0.012557516,
    0.004793121,
    0.012623375,
    -0.002473805,
    -0.0066698,
    -0.011443332,
    0.023245685,
    0.01660672,
    -0.05235666,
    -0.027087998,
    -0.015195257,
    0.046671182,
    -0.005099423,
    -0.021705914,
    -0.011711646,
    0.039230477,
    0.003291812,
    -0.027329979,
    0.078340821,
    -0.015641093,
    -0.036013778,
    -0.046857491,
    -0.013368731,
    -0.017911309,
    -0.052880313,
    -0.007944512,
    0.045309808,
    1.6362e-05,
    0.016017426,
    0.105716646,
    -0.022215707,
    -0.011940684,
    0.0076786,
    -0.006211789,
    -0.035810664,
    0.003335442,
    0.030804528,
    0.031574015,
    -0.019972101,
    -0.030223107,
    0.008020516,
    0.028527405,
    -0.061635416,
    0.050070491,
    0.006283832,
    -0.037601907,
    0.044510473,
    0.015887808,
    -0.050137836,
    -0.048148114,
    0.028245963,
    -0.017726874,
    -0.046684429,
    -0.021674328,
    0.011855237,
    0.020786503,
    -0.046092387,
    -0.024059383,
    0.037366766,
    0.013482848,
    -0.00380346,
    0.014420543,
    0.033374537,
    -0.010348098,
    -0.048050713,
    0.006682501,
    -0.008220651,
    0.002661286,
    -0.015803633,
    0.017836818,
    -0.054175481,
    0.014556644,
    0.017252944,
    -0.028141385,
    -0.031578615,
    -0.008213914,
    -0.005789469,
    0.018768914,
    -0.014019819,
    0.016589245,
    0.012211974,
    -0.014556879,
    0.026294634,
    0.012789511,
    -0.06646575,
    0.048147913,
    0.004740374,
    0.04288901,
    0.024620369,
    -0.000924318,
    -0.021926321,
    -0.005582639,
    0.008967559,
    0.020694965,
    0.038376123,
    -0.010392502,
    0.077137299,
    0.011792869,
    0.015759032,
    0.038887888,
    -0.007915318,
    0.004129587,
    0.034404986,
    0.028894043,
    0.019983809,
    -0.005030858,
    0.037082884,
    0.005648734,
    0.004085103,
    -0.062034279,
    -0.025159292,
    0.017071048,
    -0.023535561,
    0.014955604,
    0.009290888,
    0.003528432,
    0.056546398,
    0.049095139,
    -0.043312114,
    -0.036381099,
    -0.031429544,
    -0.023983255,
    -0.031766795,
    0.002582238,
    -0.022263845,
    0.005761972,
    -0.053442869,
    0.00647022,
    -0.034925912,
    0.006813447,
    0.01637817,
    0.029834604,
    0.012727759,
    0.001617412,
    -0.0326293,
    0.049752451,
    0.011144751,
    0.011936607,
    -0.01800736,
    0.008023459,
    -0.029624397,
    -0.020194128,
    -0.014803554,
    0.03023649,
    0.021834509,
    0.023886589,
    -0.013739686,
    0.008874002,
    0.021422802,
    0.012111081,
    0.020293994,
    0.03546923,
    0.014452189,
    0.049186811,
    -0.048989709,
    -0.00092677,
    0.001474745,
    0.036117006,
    -0.041923296,
    -0.007754541,
    0.0486077,
    0.011309483,
    -0.059817821,
    -0.01435172,
    -0.007680077,
    -0.015111011,
    -0.006946759,
    0.009408557,
    -0.021052781,
    0.021367166,
    0.001949727,
    -0.024419699,
    0.022330476,
    -0.040772583,
    -0.005159727,
    0.006318796,
    -0.013539038,
    0.018002719,
    -0.051814996,
    0.029076751,
    -0.018296538,
    0.001455876,
    0.016722819,
    0.017993834,
    0.030566411,
    0.012639739,
    0.00980053,
    0.032974914,
    0.003352012,
    0.00304681,
    0.035653144,
    0.041359305,
    0.001325659,
    0.072086133,
    -0.024573719,
    0.072153777,
    -0.000764444,
    0.039878011,
    -0.012257429,
    0.007767321,
    0.001167429,
    -0.02343064,
    -0.023450904,
    -0.028213223,
    0.038799718,
    0.071692795,
    -0.030036312,
    -0.034149807,
    0.01881049,
    -0.031253528,
    -0.032972332,
    -0.013815475,
    0.020945618,
    -0.003293725,
    -0.04718513,
    -0.05522009,
    0.003436799,
    0.005085181,
    0.038270149,
    -0.025692349,
    -0.003051663,
    -0.006557107,
    0.042889178,
    -0.000678327,
    0.007497834,
    -0.038652517,
    0.013153824,
    -0.053444661,
    -0.009856703,
    -0.038201787,
    -0.052686412,
    -0.030811941,
    0.012204379,
    0.095778637,
    -0.042690661,
    -0.000748044,
    0.017783366,
    0.025652226,
    -0.058418468,
    -0.019815668,
    -0.03431318,
    -0.010949592,
    -0.027463078,
    -0.023637282,
    0.006185568,
    0.020668244,
    -0.036287766,
    0.019040404,
    0.006996244,
    0.058199685,
    0.035153702,
    -0.054175917,
    -0.040384129,
    0.048727356,
    0.078026906,
    -0.008803719,
    0.039695583,
    -0.028103137,
    -0.004341313,
    -0.028438069,
    0.010577033,
    -0.012329688,
    0.029342614,
    -0.044348419,
    -0.00386984,
    0.033186693,
    0.020316252,
    0.00493172,
    -0.009869467,
    0.053987049,
    0.015627982,
    -0.047848508,
    0.038635191,
    0.044755969,
    -0.022273084,
    -0.021695036,
    0.037370022,
    0.019785952,
    -0.013031226,
    -0.001183788,
    0.009630043,
    -0.018521354,
    0.01541489,
    -0.019369291,
    0.013673407,
    0.026444532,
    -0.012232583,
    -0.008684058,
    -0.000812884,
    0.017305413,
    -0.059494786,
    0.007358964,
    -0.030337531,
    0.011038639,
    -0.007874914,
    0.053483244,
    -0.072527349,
    -0.042083569,
    0.003268881,
    0.017725334,
    0.058093056,
    -0.000672976,
    0.017287791,
    0.00075105,
    0.00491207,
    -0.047339097,
    -0.027424086,
    -0.026582547,
    0.012491137,
    -0.073696919,
    0.002467849,
    -0.006328205,
    0.004276735,
    -0.033072751,
    0.023564154,
    0.019245472,
    0.029181877,
    0.030292422,
    -0.004703511,
    0.011091347,
    0.017896295,
    -0.013794966,
    0.034894548,
    -0.040667124,
    0.007703009,
    -0.057606716,
    0.012748413,
    0.02619358,
    0.068273574,
    -0.030973088,
    -0.051012523,
    0.033550754,
    -0.00426914,
    -0.014854262,
    0.003103615,
    0.018215092,
    0.031315256,
    -0.036014143,
    -0.029734796,
    -0.017771816,
    -0.003722961,
    -0.034833349,
    -0.010804085,
    0.042228863,
    0.044097047,
    -0.027266817,
    -0.013144119,
    0.048461914,
    -0.02485008,
    0.03945284,
    0.005287179,
    -5.8885e-05,
    0.003021287,
    -0.045797579,
    0.000813941,
    0.034876458,
    -0.065420218,
    -0.07223966,
    0.0313913,
    0.016565902,
    -0.011183848,
    0.00342102,
    -0.002034782,
    0.030346483,
    0.052873351,
    -0.011449011,
    -0.01964367,
    0.011864718,
    -0.020204233,
    0.003819591,
    -0.065648302,
    -0.026348172,
    0.005125744,
    0.017323896,
    -0.006735212,
    0.063455068,
    -0.001049572,
    0.020717636,
    0.01175478,
    0.024808053,
    -0.007714119,
    0.017308436,
    0.011922769,
    0.009192253,
    0.055905398,
    -0.028699467,
    -0.019632205,
    0.005108711,
    0.005601864,
    -0.012804424,
    0.012407655,
    -0.002219189,
    0.032752734,
    0.002518875,
    0.009694873,
    -0.024529504,
    0.041552767,
    -0.018389495,
    -0.004005178,
    -0.057716407,
    -0.012430497,
    0.093697846,
    0.018073434,
    -0.025177741,
    0.002106016,
    -0.000810776,
    -0.016135544,
    0.014573466,
    -0.048934873,
    -0.021403028,
    0.01594897,
    -0.020527802,
    -0.024213936,
    -0.034914419,
    -0.041677888,
    0.010246526,
    -0.016627172,
    0.039000474,
    -0.008376523,
    -0.020690175,
    0.01442386,
    -0.012706691,
    0.041290712,
    0.007572809,
    0.003830229,
    0.060000371,
    0.004978953,
    -0.001236652,
    -0.039849725,
    0.016330607,
    0.027721943,
    -0.083184935,
    -0.019897826,
    0.012030544,
    0.024155978,
    0.027711164,
    0.032444462,
    -0.00162281,
    -0.014051185,
    0.000874289,
    0.004953789,
    -0.019065749,
    0.001869103,
    -0.015271718,
    0.005259292,
    0.027984653,
    -0.000392502,
    0.011772431,
    0.023931723,
    0.006179267,
    0.040898081,
    0.017972199,
    -0.00938494,
    0.002409419,
    -0.050738379,
    -0.018213939,
    0.045892566,
    0.025484841,
    -0.008070608,
    0.00444631,
    -0.038671296,
    -0.036740296,
    -0.048912786,
    0.010171526,
    0.068610065,
    0.012804976,
    0.040166259,
    -0.058614783,
    -0.03765168,
    0.014438173,
    0.016542034,
    -0.025465082,
    -0.006570164,
    -0.022310453,
    0.003891058,
    0.002160652,
    0.02914718,
    0.006806807,
    0.062344555,
    0.039257124,
    -0.004345173,
    0.020155637,
    -0.040939916,
    -0.046788581,
    -0.050038889,
    0.010234407,
    0.011990074,
    -0.013396511,
    -0.010935748,
    0.010787514,
    0.005347143,
    0.045579419,
    -0.031664446,
    -0.009198969,
    0.002801261,
    0.006054025,
    -0.023789484,
    -0.016411223,
    -0.072537161,
    -0.069053717,
    0.027813474,
    0.005470902,
    -0.004983875,
    0.021294994,
    -0.037043795,
    0.015644861,
    -0.007040296,
    0.022917202,
    0.011620793,
    -0.022751769,
    0.046218615,
    0.010180866,
    0.024584876,
    -0.025557403,
    0.016100058,
    -0.027246291,
    -0.007570676,
    -0.026188584,
    -0.015326736,
    -0.012602004,
    0.045142643,
    0.038147297,
    -0.016030302,
    0.050260097,
    0.01496596,
    0.000531598,
    -0.060442042,
    -0.030808041,
    0.027007725,
    -0.048913375,
    -0.020681323,
    -0.025930416,
    0.011481375,
    0.045092184,
    0.02804306,
    -0.033004701,
    -0.007801805,
    -0.013800435,
    0.002902737,
    -0.012884825,
    -0.009065162,
    0.028795836,
    0.027188938,
    0.035053827,
    -0.012998849,
    -0.030920001,
    -0.03122407,
    -0.004032437,
    -0.005134284,
    0.045262065,
    0.006893179,
    -0.019301815,
    0.002058804,
    0.004889466,
    0.013528937,
    0.020998171,
    0.006497652,
    0.006289458,
    -0.056745186,
    0.015710343,
    -0.00773979,
    -0.01665345,
    -0.008627808,
    0.008344181,
    -0.051388331
  ],
  "metadata": {
    "language": "cs",
    "type": "commit_diff"
  },
  "payload": {
    "type": "commit_diff",
    "diff_type": "modified",
    "commit_hash": "266684124654cd11e8611089643cfdb1d41b936e",
    "commit_timestamp": 1754539501,
    "commit_date": "2025-08-06",
    "commit_message": "Complete 7-Phase TxtDb System Transformation\n\nMAJOR ACHIEVEMENTS:\n- Transformed system from ~40-50% to 95-100% pass rate\n- Fixed fundamental data visibility issues with JSON type handling\n- Implemente",
    "author_name": "jsbattig",
    "author_email": "jsbattig@gmail.com",
    "path": "TxtDb.Storage/Services/Async/AsyncLockManager.cs",
    "chunk_index": 2,
    "char_start": 0,
    "char_end": 0,
    "project_id": "txt-db",
    "language": "cs",
    "file_extension": "cs"
  },
  "chunk_text": "sal coordination to prevent race conditions\n     /// </summary>\n     public void Dispose()\n     {\n         if (!_disposed)\n         {\n-            _disposed = true;\n-\n-            // Mark all active lock handles as disposed\n-            foreach (var lockHandle in _activeLockHandles)\n+            // Set disposal flags atomically\n+            lock (_lockCreationLock)\n             {\n-                lockHandle.MarkAsDisposed();\n+                if (_disposed) return;\n+                _disposing = true;\n+                _disposed = true;\n             }\n-\n-            // Dispose all semaphores\n-            foreach (var semaphore in _locks.Values)\n+            \n+            // Mark all active lock handles as disposed (snapshot to avoid collection modification)\n+            try\n             {\n-                try\n+                var handleArray = _activeLockHandles.ToArray();\n+                foreach (var lockHandle in handleArray)\n                 {\n-                    semaphore.Dispose();\n+                    try\n+                    {\n+                        lockHandle.MarkAsDisposed();\n+                    }\n+                    catch\n+                    {\n+                        // Ignore disposal errors for handles\n+                    }\n                 }\n-                catch\n+            }\n+            catch\n+            {\n+                // Ignore enumeration errors during disposal\n+            }\n+\n+            // Dispose all semaphores (snapshot to avoid collection modification)\n+            try\n+            {\n+                var lockArray = _locks.ToArray();\n+                foreach (var kvp in lockArray)\n                 {\n-                    // Ignore disposal errors\n+                    try\n+                    {\n+                        kvp.Value.Dispose();\n+                    }\n+                    catch\n+                    {\n+                        // Ignore disposal errors\n+                    }\n                 }\n             }\n+            catch\n+            {\n+                // Ignore enumeration errors during disposal\n+            }\n \n-            _locks.Clear();\n-            _lockReferenceCounts.Clear();\n+            // Clear collections\n+            try\n+            {\n+                _locks.Clear();\n+                _lockReferenceCounts.Clear();\n+            }\n+            catch\n+            {\n+                // Ignore clearing errors\n+            }\n+            \n+            // Signal completion of disposal\n+            try\n+            {\n+                _disposalCompletionSource.TrySetResult(true);\n+            }\n+            catch\n+            {\n+                // Ignore completion source errors\n+            }\n         }\n     }\n }\n \n /// <summary>"
}