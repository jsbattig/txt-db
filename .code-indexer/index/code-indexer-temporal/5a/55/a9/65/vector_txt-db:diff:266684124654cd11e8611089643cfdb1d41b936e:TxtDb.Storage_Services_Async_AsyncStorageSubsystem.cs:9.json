{
  "id": "txt-db:diff:266684124654cd11e8611089643cfdb1d41b936e:TxtDb.Storage/Services/Async/AsyncStorageSubsystem.cs:9",
  "vector": [
    0.01497882,
    -0.012393259,
    -0.005900309,
    0.018435657,
    0.025423525,
    0.008311128,
    -0.008461273,
    -0.009536136,
    0.048207704,
    -0.013836052,
    0.002369292,
    -0.001186814,
    0.053885065,
    0.008535129,
    -0.08121407,
    -0.04557316,
    0.033019815,
    -0.005403639,
    -0.052274417,
    0.017779214,
    -0.008328152,
    -0.071051873,
    -0.056280348,
    0.050831724,
    -0.069164909,
    0.003906637,
    0.030152107,
    0.057569034,
    -0.00385447,
    0.042710971,
    0.004089819,
    -0.057788629,
    0.005792068,
    0.009271891,
    0.03235982,
    -0.000866068,
    -0.019369714,
    -0.022443926,
    -0.020394839,
    0.035365086,
    0.007789757,
    -0.045011919,
    0.047222789,
    -0.020243971,
    0.008382752,
    -0.041576583,
    0.020222036,
    0.011643277,
    -0.010519155,
    0.028544178,
    -0.022235468,
    0.006377472,
    -0.022022447,
    0.035345946,
    0.029156303,
    -0.090413056,
    0.070766032,
    0.018146345,
    -0.043575056,
    0.075767413,
    -0.030980621,
    -0.008480597,
    0.012152232,
    0.017197454,
    0.004996855,
    -0.06471885,
    -0.064164586,
    0.060456011,
    0.053854618,
    -0.053073965,
    0.003933414,
    0.047597386,
    -0.011610841,
    0.0382035,
    0.022529971,
    0.004968472,
    0.052997746,
    0.022827577,
    0.051567905,
    0.010760987,
    -0.041406456,
    -0.057989985,
    0.001302506,
    -0.030366024,
    0.028055752,
    -0.032315832,
    0.01371951,
    -0.069874279,
    -0.011819038,
    -0.021942908,
    -0.016866466,
    0.049003601,
    0.032488693,
    -0.011403672,
    0.025208013,
    0.026853427,
    0.006142413,
    -0.01219915,
    0.03141756,
    -0.024010587,
    0.001193488,
    0.014430065,
    -0.036071852,
    0.062419254,
    -0.073506728,
    -0.008307829,
    0.015615062,
    -0.043427501,
    -0.015178832,
    0.019283537,
    0.058265265,
    0.020947926,
    0.00934019,
    -0.01419319,
    -0.006576932,
    0.007018514,
    0.00278091,
    -0.032243107,
    0.021638975,
    0.039601751,
    -0.041558348,
    0.013142104,
    -0.068743818,
    0.077217944,
    -0.023054047,
    0.06403549,
    0.018785518,
    0.046974584,
    -0.008174293,
    -0.044012424,
    -0.001169332,
    -0.034015901,
    0.01078839,
    0.00757841,
    -0.014921675,
    0.013432444,
    0.011818897,
    0.038882207,
    0.00169399,
    -0.059699386,
    0.021155592,
    -0.017303726,
    0.007697802,
    0.035167459,
    -0.014129405,
    0.021033656,
    0.04535412,
    0.015699517,
    0.016467003,
    -0.069328964,
    -0.015320438,
    0.058167472,
    -0.037222415,
    -0.005842573,
    0.006638933,
    0.028120272,
    -0.037543494,
    -0.018226711,
    0.02148485,
    -0.025839569,
    -0.047275953,
    0.026702957,
    0.010975353,
    0.004367763,
    -0.052508835,
    0.037255511,
    0.025892267,
    0.003846509,
    0.02056649,
    -0.034874212,
    -0.083875522,
    0.005624005,
    -0.062884249,
    -0.007418417,
    -0.073356375,
    -0.022281123,
    0.049145453,
    0.018218847,
    -0.066337392,
    -0.036840782,
    0.008601063,
    0.002760948,
    -0.012358907,
    0.010131875,
    0.010561322,
    -0.033655852,
    0.049985364,
    0.018354332,
    0.025671406,
    0.015703801,
    -0.042256836,
    -0.017889291,
    -0.032257333,
    -0.017514339,
    0.018511003,
    -0.00542326,
    -0.021070426,
    -0.004567631,
    0.025864758,
    0.027371392,
    -0.028961312,
    0.037799791,
    -0.059571113,
    -0.001139603,
    0.029219273,
    -0.008678594,
    -0.033126049,
    -0.039229941,
    0.011004876,
    0.03022146,
    -0.01805098,
    -0.034856301,
    0.012338882,
    -0.001101668,
    -0.002735977,
    0.017146347,
    -0.045918185,
    -0.000428102,
    0.056434911,
    0.000984309,
    0.009178961,
    -0.038761653,
    0.044452053,
    0.026907215,
    -0.017956397,
    -0.041805472,
    -0.051932655,
    -0.032232173,
    -0.042166024,
    -0.028486881,
    0.010502047,
    -0.025434555,
    0.024964266,
    -0.038349979,
    -0.04087498,
    0.053890698,
    0.001935548,
    -0.00120504,
    0.003676072,
    -0.016759051,
    -0.023359952,
    0.043659586,
    -0.016356448,
    -0.015973819,
    -0.026242753,
    0.006854767,
    0.037722122,
    0.024200153,
    -0.019871142,
    0.010275528,
    -0.030045347,
    0.051812105,
    -0.026821399,
    0.098735213,
    0.071837418,
    0.011769668,
    -0.008995909,
    0.005270699,
    -0.001245179,
    -0.009737064,
    0.002522554,
    -0.005469947,
    -0.024627496,
    0.065865904,
    -0.006847364,
    0.026633589,
    -0.031358078,
    -0.038714591,
    -0.010679961,
    0.045715164,
    0.003522244,
    0.016374059,
    0.053036273,
    0.021379687,
    -0.01060001,
    -0.023231653,
    0.034517836,
    0.037307374,
    0.028431341,
    0.004022909,
    -0.047444932,
    0.00900558,
    0.008151106,
    -0.02920508,
    -0.008838927,
    -0.053451207,
    0.010461316,
    -0.009454797,
    0.057997871,
    0.021382531,
    0.021034312,
    -0.016748786,
    0.005513956,
    -0.014015705,
    0.054587632,
    0.028604958,
    0.028054314,
    -0.026195884,
    0.012906042,
    -0.034833942,
    -0.01057284,
    -0.011769358,
    0.043400604,
    0.022597067,
    0.002590607,
    0.021516696,
    0.034193002,
    -0.030721337,
    0.000737705,
    -0.013843446,
    -0.030026399,
    -0.017571682,
    0.017665735,
    -0.004454782,
    0.025405575,
    -0.078387029,
    -0.050274365,
    -0.007213356,
    -0.031798083,
    -0.0024722,
    0.006604677,
    -0.008962613,
    0.037016485,
    -0.089490913,
    0.012804813,
    -0.017303862,
    -0.042104479,
    -0.021654619,
    0.0279331,
    -0.02245458,
    -0.009021032,
    0.047197014,
    -0.005218418,
    0.047252189,
    -0.016046068,
    0.021250732,
    -0.028850783,
    -0.009587014,
    -0.034603808,
    0.006713383,
    0.013449876,
    -0.02582955,
    0.022889402,
    -0.029432569,
    0.067711718,
    -0.008877869,
    0.031194258,
    -0.00093002,
    -0.008634041,
    0.056323778,
    0.009259283,
    -0.056644566,
    -0.020116316,
    0.000336109,
    -0.044741992,
    0.023504933,
    -0.008077718,
    0.008351141,
    0.002752017,
    0.036027022,
    0.025266927,
    0.028038243,
    -0.054741237,
    -0.033274524,
    -0.022677936,
    0.006238795,
    -0.035472088,
    0.076537751,
    -0.018582709,
    0.015855834,
    -0.052462231,
    -0.066394165,
    -0.035284843,
    0.030008333,
    -0.010683135,
    0.030027045,
    0.015289761,
    0.017777208,
    -0.025694434,
    -0.013701244,
    0.010891805,
    0.007917282,
    0.026551988,
    -0.009841357,
    -0.020420978,
    -0.045813736,
    0.017117215,
    0.027307047,
    -0.008212115,
    0.041182298,
    -0.030239778,
    0.007853464,
    0.018845407,
    -0.015666045,
    0.006544276,
    -0.023902843,
    -0.024974752,
    0.034583431,
    -0.020116238,
    -0.049187765,
    0.008640283,
    -0.007387177,
    0.026878133,
    -0.054787334,
    0.019634707,
    0.018268054,
    0.000211403,
    0.027547603,
    -0.012136326,
    0.038504079,
    0.001417523,
    0.043200463,
    -0.040866904,
    0.013336248,
    -0.043565925,
    0.023039399,
    -0.026624737,
    -0.015345123,
    0.002699216,
    0.005238084,
    -0.020131258,
    -0.05197138,
    -0.020018809,
    0.0040404,
    -0.03367389,
    0.004224731,
    -0.011863076,
    -0.07103014,
    -0.035687361,
    0.000219155,
    -0.011426948,
    0.001993754,
    -0.060945321,
    -0.011889888,
    0.047025312,
    -0.059050057,
    0.035816327,
    0.01483115,
    -0.021773107,
    -0.040220588,
    -0.0007029,
    -0.036961697,
    0.023637854,
    -0.029095232,
    -0.01828694,
    -0.033157483,
    0.018198948,
    0.060734481,
    -0.023209127,
    -0.048870001,
    -0.051584613,
    -0.034961216,
    -0.03516702,
    0.001383537,
    0.071770899,
    -0.030702924,
    -0.005994756,
    0.044697609,
    0.010607674,
    -0.029211387,
    -0.047668684,
    -0.011812256,
    -0.013610709,
    0.01281317,
    -0.017207164,
    -0.007229564,
    0.011549162,
    -0.047619425,
    -0.015515796,
    -0.000410136,
    0.034736842,
    -0.039065029,
    -0.006633361,
    0.033960074,
    0.042487826,
    0.000957028,
    0.019356921,
    0.040559772,
    -0.010547797,
    -0.040002864,
    -0.01081605,
    -0.025539672,
    -0.01069489,
    -0.050783843,
    -0.003297864,
    0.003470189,
    -0.00942155,
    0.029169073,
    0.018348366,
    -0.02378452,
    -0.008544755,
    -0.002305607,
    -0.03237484,
    0.000516864,
    0.024140017,
    -0.007696118,
    -0.015360422,
    -0.041816674,
    -0.04392948,
    0.036633305,
    0.020694723,
    -0.077886619,
    0.021361634,
    -0.024571346,
    -0.029371468,
    0.025018422,
    0.004295087,
    -0.032614321,
    -0.086897828,
    0.036564101,
    -0.01937337,
    0.010665431,
    -0.00928136,
    0.003573445,
    0.03742519,
    -0.039430846,
    -0.018352712,
    0.051914606,
    0.025633784,
    0.000673371,
    0.015760668,
    0.003406822,
    -0.024116781,
    -0.017216472,
    -0.003563703,
    0.034407545,
    0.012675301,
    0.011112341,
    0.011684986,
    -0.02203065,
    0.002255449,
    -0.017244365,
    -0.005389698,
    -0.026624415,
    0.024357278,
    -0.024164299,
    0.004008873,
    0.035477456,
    -0.007164226,
    -0.013143052,
    -0.04192372,
    0.01395997,
    -0.001831359,
    -0.045749143,
    0.036489379,
    0.007206396,
    0.001551279,
    0.005066532,
    -0.001699602,
    0.014863878,
    -0.002009549,
    0.03319858,
    0.04219275,
    0.039242934,
    -0.055238765,
    0.059562836,
    0.037087899,
    -0.006577631,
    0.057922427,
    -0.008558058,
    0.063310057,
    0.024377698,
    0.027651142,
    0.011037732,
    -0.051459912,
    0.013719563,
    0.038890298,
    0.016991926,
    -0.028904863,
    -0.008115476,
    0.002693404,
    -0.026312141,
    -0.001095824,
    -0.000493093,
    -0.01441621,
    0.034789685,
    0.056932848,
    -0.067991793,
    -0.010718419,
    0.009012987,
    0.00585203,
    0.008556738,
    0.020075357,
    0.019357536,
    0.008706858,
    -0.070805535,
    0.038565852,
    -0.01423664,
    -0.028383324,
    -0.036343183,
    0.02772362,
    -0.01236155,
    0.021367611,
    -0.036101334,
    0.050313368,
    0.025672292,
    -0.014136914,
    -0.00587695,
    -0.016736673,
    -0.054716762,
    -0.012392329,
    0.015858183,
    0.042511869,
    0.017203731,
    0.013720338,
    -0.047960911,
    0.025453512,
    -0.027044982,
    0.045637831,
    0.027964383,
    -0.001290797,
    0.028804218,
    0.078604862,
    -0.007011144,
    0.009781909,
    0.015490531,
    0.006756944,
    -0.082860023,
    0.040670589,
    -0.001241236,
    0.032155804,
    -0.048023313,
    -0.035638623,
    -0.001429967,
    0.009791282,
    -0.038306683,
    0.024855394,
    0.008017682,
    -0.005715823,
    0.014209742,
    -0.022420673,
    0.035778485,
    -0.060505152,
    0.031600095,
    0.002475136,
    0.006841308,
    0.017061649,
    0.029487513,
    -0.004788836,
    -0.010500917,
    0.005398784,
    0.003995309,
    0.005705307,
    0.017070696,
    0.060663745,
    0.030463815,
    0.053614724,
    -0.040005427,
    -0.007938894,
    0.049207848,
    0.015433037,
    0.017367741,
    0.082723856,
    0.050255682,
    0.035980165,
    0.025689172,
    0.03092186,
    -0.017893838,
    -0.018666735,
    -0.006487015,
    -0.00646951,
    -0.048706982,
    -0.014554379,
    0.004828603,
    0.039804,
    -0.026449883,
    0.005545174,
    0.01208135,
    -0.032835446,
    -0.008504694,
    -0.006334758,
    0.012098469,
    -0.01775939,
    -0.04341897,
    -0.014669358,
    -0.005021334,
    -0.004480768,
    0.013491645,
    -0.022385068,
    -0.021296686,
    0.005545053,
    0.053116292,
    -0.015462436,
    -0.008866259,
    -0.052185118,
    -0.005511808,
    -0.030048709,
    0.026036792,
    -0.018511366,
    0.00944229,
    -0.007913177,
    -0.027599847,
    0.079275139,
    -0.004435842,
    0.009461901,
    -0.014033698,
    0.036738843,
    -0.009472462,
    -0.041534971,
    -0.010044082,
    -0.021448035,
    0.030897459,
    -0.016954925,
    0.026988626,
    0.001461037,
    -0.023690987,
    -0.024208918,
    -0.07092429,
    0.086463928,
    -0.005841853,
    -0.000240338,
    -0.00823623,
    0.003130892,
    0.015637204,
    0.014708828,
    -0.025492696,
    -0.032157652,
    -0.043181799,
    -0.012337695,
    0.047591265,
    0.049565196,
    -0.025559051,
    -0.023247149,
    -0.002300178,
    -0.006629317,
    0.002914354,
    0.00749939,
    -0.002783129,
    0.052517883,
    -0.001677726,
    -0.016133392,
    0.01447588,
    -0.012320082,
    0.047758717,
    -0.054767095,
    -0.005935211,
    -0.044413108,
    0.038714834,
    -0.041062247,
    0.016588025,
    -0.003543955,
    0.02115644,
    -0.037270159,
    0.003356579,
    0.020663464,
    -0.002948034,
    0.003853143,
    0.036457773,
    -0.009604804,
    -0.053316731,
    -0.008088083,
    0.006817606,
    0.006406614,
    -0.000830023,
    0.050866697,
    0.009306357,
    -0.025564529,
    0.031776156,
    0.002826317,
    0.044311892,
    -0.033066902,
    0.004569327,
    -0.008484109,
    -0.030989312,
    -0.027498672,
    -0.02602564,
    0.023728507,
    0.0055872,
    -0.083025597,
    -0.004640872,
    -0.04075757,
    0.000997186,
    -0.050377678,
    0.005988412,
    -0.018798992,
    -0.056721341,
    0.019265624,
    0.012724808,
    -0.063426144,
    0.005479547,
    0.003046519,
    0.014705635,
    0.008054221,
    -0.031641468,
    -0.004761669,
    -0.009291611,
    0.019542933,
    0.0253789,
    -0.018910747,
    -0.067102991,
    0.041868869,
    0.003363619,
    -0.023775898,
    0.022914562,
    0.005868805,
    0.020730119,
    -0.069633558,
    -0.038631789,
    0.027265549,
    -0.027768442,
    -0.04258702,
    0.050564218,
    0.015136245,
    0.042355008,
    -0.015340492,
    -0.010315139,
    0.072733499,
    0.010940635,
    0.019540299,
    0.010754189,
    0.004576767,
    0.010043875,
    -0.05317381,
    -0.006272977,
    0.040872399,
    -0.019370673,
    -0.068005018,
    0.014230498,
    -0.007030153,
    -0.018312462,
    -0.002565792,
    0.024666183,
    0.009902744,
    0.015950143,
    -0.036533155,
    0.011227076,
    0.015109779,
    -0.002687844,
    0.002759401,
    0.02267568,
    -0.066024646,
    0.02064115,
    -0.00018318,
    -0.038842324,
    0.041054435,
    -0.003803271,
    -0.033855326,
    0.045845386,
    0.006206277,
    -0.040836729,
    -0.025541149,
    -0.009783689,
    0.030040439,
    -0.019754758,
    -0.018961148,
    -0.067025065,
    0.001540784,
    0.00434099,
    -0.031162409,
    0.022527378,
    0.011232859,
    -0.009039843,
    -0.022175618,
    -0.017485224,
    -0.018785642,
    0.04171126,
    0.025623025,
    0.049195468,
    -0.057095908,
    -0.036676034,
    0.058857255,
    0.000106668,
    0.004062991,
    -0.017925404,
    -0.040009107,
    -0.03852376,
    -0.00223025,
    -0.005646436,
    -0.015291158,
    -0.014933379,
    -0.008388162,
    0.038923323,
    -0.047673456,
    -0.00341635,
    0.030862497,
    -0.00072389,
    0.02114282,
    -0.00835696,
    -0.043141671,
    0.006385307,
    -0.014532828,
    0.006258912,
    0.019499265,
    0.035822995,
    0.023391323,
    -0.033496648,
    -0.027093796,
    -0.034657359,
    -0.026200412,
    0.044827424,
    -0.045837052,
    -0.023265226,
    -0.011776811,
    0.046333749,
    -0.010825098,
    0.065877594,
    -0.007985752,
    -0.025783241,
    -0.013858135,
    0.012180904,
    -0.001970885,
    0.040372856,
    -0.041546553,
    0.059952319,
    0.012180622,
    0.018224096,
    -0.011080844,
    -0.00264999,
    0.008506671,
    0.046975799,
    0.013360798,
    -0.030670909,
    -0.009198092,
    -0.021104908,
    -0.019413084,
    0.000563641,
    0.039782386,
    0.035508301,
    -0.009306544,
    -0.031431887,
    0.024795875,
    -0.013386435,
    -0.001617818,
    0.004974937,
    0.003839866,
    0.013151168,
    -0.070792072,
    -0.009699983,
    -0.015297627,
    0.021040697,
    -0.034392383,
    0.008155112,
    -0.002658226,
    0.025974434,
    0.01070895,
    -0.011477428,
    -0.017267542,
    0.045661021,
    0.043518331,
    -0.039265472,
    0.002138016,
    -0.018295797,
    -0.040112738,
    -0.002239252,
    -0.058117773,
    -0.007775227,
    -0.011457751,
    0.045445889,
    0.009599872,
    -0.026664693,
    -0.01496686,
    0.010259066,
    -0.001119548,
    0.054393481,
    0.039563429,
    0.010847059,
    -0.013485687,
    -0.003391252,
    -0.06060629,
    -0.028523661,
    -0.018727805,
    -0.031661954,
    0.018340485,
    0.03563904,
    0.029395673,
    0.017895628,
    0.029703263,
    0.030907478,
    0.030970141,
    0.01639338,
    0.003258648,
    -0.006063403,
    -0.039850287,
    -0.003596718,
    -0.012375016,
    -0.01719499,
    0.034319699,
    0.010064302,
    -0.025636366,
    0.01624975,
    0.035358012,
    -0.00221052,
    0.056180049,
    -0.018729763,
    -0.002562348,
    -0.012096856,
    -0.027023906,
    0.044077635,
    -0.025840381,
    -0.027901234,
    -0.021526942,
    0.004836116,
    -0.001015114,
    0.011581363,
    0.014364528,
    -0.015238843,
    -0.032041512,
    -0.036390431,
    0.039123859,
    -0.03321448,
    0.030106118,
    -0.011828735,
    0.025934577,
    0.019479165,
    0.005441546,
    -0.03459166,
    0.009541273,
    0.012546474,
    0.024629528,
    0.057028394,
    0.017697122,
    0.027871031,
    0.031752344,
    -0.000579414,
    -0.011917815,
    0.036263809,
    0.038556628,
    0.0051522,
    0.006302193,
    0.003265911,
    0.000366947,
    -0.027916478,
    0.008627607,
    -0.048800457
  ],
  "metadata": {
    "language": "cs",
    "type": "commit_diff"
  },
  "payload": {
    "type": "commit_diff",
    "diff_type": "modified",
    "commit_hash": "266684124654cd11e8611089643cfdb1d41b936e",
    "commit_timestamp": 1754539501,
    "commit_date": "2025-08-06",
    "commit_message": "Complete 7-Phase TxtDb System Transformation\n\nMAJOR ACHIEVEMENTS:\n- Transformed system from ~40-50% to 95-100% pass rate\n- Fixed fundamental data visibility issues with JSON type handling\n- Implemente",
    "author_name": "jsbattig",
    "author_email": "jsbattig@gmail.com",
    "path": "TxtDb.Storage/Services/Async/AsyncStorageSubsystem.cs",
    "chunk_index": 9,
    "char_start": 0,
    "char_end": 0,
    "project_id": "txt-db",
    "language": "cs",
    "file_extension": "cs"
  },
  "chunk_text": "               \n-                    var versionFile = Path.Combine(namespacePath, $\"{pageId}{_formatAdapter.FileExtension}.v{version}\");\n-                    if (File.Exists(versionFile))\n-                    {\n-                        var content = File.ReadAllText(versionFile);\n-                        return _formatAdapter.DeserializeArray(content, typeof(object));\n+                        bool isOwnWrite = (version == transactionId);\n+                        bool isFromOtherActiveTransaction = _metadata.ContainsActiveTransaction(version) && version != transactionId;\n+                        bool isRolledBack = IsVersionRolledBack(version);\n+                        \n+                        // MVCC VERSION EVALUATION: Check visibility rules for this version\n+                        \n+                        // Skip versions from other active transactions (maintain isolation)\n+                        if (isFromOtherActiveTransaction)\n+                        {\n+                            // Skip: Version from concurrent active transaction (isolation)\n+                            continue;\n+                        }\n+                            \n+                        // Skip rolled back versions\n+                        if (isRolledBack)\n+                        {\n+                            // Skip: Version was rolled back\n+                            continue;\n+                        }\n+                            \n+                        // Allow own writes regardless of snapshot TSN (read-your-own-writes consistency)\n+                        // Also allow committed versions within snapshot TSN\n+                        if (isOwnWrite || version <= transaction.SnapshotTSN)\n+                        {\n+                            var versionFile = Path.Combine(namespacePath, $\"{pageId}{_formatAdapter.FileExtension}.v{version}\");\n+                            // Load the visible version file\n+                            if (File.Exists(versionFile))\n+                            {\n+                                // Check cancellation before reading file content\n+                                cancellationToken.ThrowIfCancellationRequested();\n+                                var content = File.ReadAllText(versionFile);\n+                                \n+                                // Check cancellation before deserialization (CPU-intensive for large data)\n+                                cancellationToken.ThrowIfCancellationRequested();\n+                                return _formatAdapter.DeserializeArray(content, typeof(object));\n+                            }\n+                        }\n+                        else\n+                        {\n+                            // Skip: Version beyond snapshot TSN and not own write\n+                        }\n                     }\n                 }\n-            }\n-            \n-            return Array.Empty<object>();\n-        }, cancellationToken).ConfigureAwait(false);\n+                \n+                return Array.Empty<object>();\n+            }, cancellationToken).ConfigureAwait(false);\n+        }\n+        catch (TaskCanceledException ex) when (ex.CancellationToken == cancellationToken)\n+        {\n+            // Convert TaskCanceledException to OperationCanceledException for consistent exception handling\n+            // This ensures tests expecting OperationCanceledException will pass\n+            throw new OperationCanceledException(\"Operation was cancelled during page read\", ex, cancellationToken);\n+        }\n     }\n     \n     private async Task WritePageVersionAsync(long transactionId, string namespaceName, string pageId, object[] content, CancellationToken cancellationToken)\n     {\n-        await Task.Run(async () =>\n+        try\n         {\n-            cancellationToken.ThrowIfCancellationRequested();\n-            \n-            var namespacePath = GetNamespacePath(namespaceName);\n-            var versionFile = Path.Combine(namespacePath, $\"{pageId}{_formatAdapter.FileExtension}.v{transactionId}\");\n-            var fullPageId = $\"{namespaceName}:{pageI"
}