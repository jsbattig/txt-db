{
  "id": "txt-db:diff:266684124654cd11e8611089643cfdb1d41b936e:TxtDb.Storage/Services/Async/AsyncStorageSubsystem.cs:12",
  "vector": [
    0.009084148,
    -0.002965805,
    -0.00209613,
    0.032191489,
    -0.009025068,
    -0.031315353,
    0.001805897,
    -0.035324436,
    0.026090054,
    0.020860357,
    0.041204143,
    -0.025250051,
    0.073642418,
    -0.025798636,
    -0.058813423,
    -0.042666696,
    0.02203753,
    0.002398492,
    -0.062779002,
    0.010939193,
    -0.017967403,
    -0.057283506,
    -0.065577209,
    0.070368446,
    -0.050652951,
    0.002986854,
    0.02709618,
    0.033518869,
    0.011959757,
    0.057082176,
    -0.002344554,
    -0.055226814,
    -0.012115037,
    0.042962372,
    0.018737342,
    -0.0109938,
    -0.010093783,
    0.006301101,
    0.008573571,
    0.002946701,
    0.035570327,
    -0.029414326,
    0.058294747,
    -0.023322316,
    -0.026159212,
    -0.044226557,
    0.023073539,
    0.006941912,
    -0.007710256,
    -0.017680598,
    -0.016118564,
    -0.008558577,
    0.000419916,
    0.010517515,
    -0.002626697,
    -0.03912466,
    0.092599295,
    0.022060078,
    -0.062666669,
    0.065486193,
    -0.009091618,
    0.001765233,
    -0.015420954,
    0.030680366,
    -0.020561742,
    -0.031579588,
    -0.069377102,
    0.048791982,
    -0.010947956,
    -0.062312972,
    0.012094949,
    0.040767599,
    -0.009628187,
    0.018045325,
    0.028487155,
    0.021713963,
    0.041278835,
    0.03310195,
    0.033653282,
    0.03766476,
    -0.04979429,
    -0.062826768,
    0.005174537,
    -0.025858046,
    0.045594897,
    -0.033509493,
    -0.002913975,
    -0.061804246,
    0.005258198,
    0.001924359,
    -0.028705426,
    0.036822114,
    0.0315459,
    0.005133392,
    0.025740296,
    0.034547657,
    0.04446141,
    0.006643105,
    0.023585711,
    -0.015423786,
    -0.006052921,
    0.018643003,
    -0.017073777,
    0.053218789,
    -0.052879937,
    -0.024521107,
    0.018678965,
    -0.042320032,
    0.008885794,
    0.0340412,
    0.031969089,
    0.004540114,
    0.025539286,
    0.008997494,
    0.011964411,
    -0.018750198,
    -0.015843896,
    -0.006219192,
    0.012746708,
    0.024054103,
    -0.040426008,
    0.020428829,
    -0.07971622,
    0.051408835,
    -0.013898745,
    0.040047135,
    0.021576967,
    0.015594156,
    0.023593735,
    -0.013289493,
    0.007657765,
    -0.000688289,
    -0.022128651,
    0.010992593,
    -0.012936033,
    0.026613066,
    0.036171589,
    0.013419962,
    0.006873003,
    -0.061109763,
    0.01787791,
    0.002280613,
    -0.009218377,
    0.021754174,
    -0.00241532,
    0.028405853,
    0.033981722,
    0.009910654,
    0.02710042,
    -0.070529275,
    -0.014371481,
    0.036709212,
    -0.038165752,
    0.003146332,
    0.008282469,
    -0.006339206,
    -0.021965533,
    -0.02491455,
    0.003654234,
    -0.018787969,
    -0.044520263,
    0.027966464,
    -0.00085393,
    0.026160704,
    -0.004230019,
    0.029596983,
    0.018740579,
    0.007502309,
    0.041548304,
    -0.020551259,
    -0.06863331,
    0.020457059,
    -0.074170709,
    -0.018790606,
    -0.017533839,
    0.028898925,
    0.020993408,
    -0.002016974,
    -0.078261271,
    -0.034889545,
    0.030352488,
    -0.013729161,
    -0.008320817,
    -0.008082604,
    0.010809981,
    0.003316027,
    0.054226026,
    0.007317859,
    0.023519125,
    -0.004769336,
    -0.026748093,
    0.000234444,
    -0.021286666,
    -0.026344208,
    -0.009759113,
    -0.032510735,
    -0.025618417,
    -0.015690012,
    -0.000897815,
    0.012723658,
    -0.064201482,
    0.040611375,
    -0.088866442,
    -0.022915576,
    0.018025657,
    -0.017326802,
    -0.041643746,
    -0.010165064,
    0.004520156,
    0.011916084,
    -0.004997742,
    0.003924277,
    0.011703161,
    -0.001717707,
    0.059254188,
    0.001089365,
    -0.023279065,
    -0.014990197,
    0.039646234,
    -0.004865413,
    -0.016173186,
    -0.01248226,
    0.092761196,
    0.048162617,
    -0.016419815,
    -0.050881844,
    -0.033591673,
    -0.055919517,
    -0.022968812,
    -0.019590797,
    0.03513208,
    -0.047540616,
    0.013632297,
    -0.03318971,
    -0.042619243,
    0.071601056,
    -0.020038469,
    -0.026292209,
    -0.001493065,
    -0.014273359,
    -0.028291684,
    0.062303331,
    -0.006552965,
    0.036840957,
    -0.00224412,
    0.024635119,
    0.070173934,
    0.012938137,
    -0.004145528,
    0.030805724,
    -0.015668549,
    0.020054467,
    -0.017864456,
    0.109888539,
    0.075923488,
    -0.011065847,
    -0.017871248,
    0.044115547,
    -0.002940764,
    0.008225474,
    0.007442958,
    -0.00433684,
    -0.00773565,
    0.028616976,
    -0.017234778,
    0.021947838,
    -0.032796014,
    -0.038923174,
    0.007089502,
    0.027965615,
    0.021796528,
    0.004077158,
    0.043824509,
    0.038693152,
    -0.007567757,
    -0.049808566,
    0.019892717,
    0.019147417,
    0.014566345,
    0.023206092,
    -0.037554059,
    -0.000601048,
    0.002681782,
    -0.017737566,
    -0.03571282,
    -0.043661159,
    0.001490257,
    -0.010257636,
    0.03595468,
    0.011128966,
    0.011536078,
    -0.008826844,
    -0.008247379,
    -0.019415582,
    0.046366718,
    0.022510003,
    0.044660907,
    -0.022143126,
    0.032315511,
    -0.029100442,
    -0.019631578,
    0.001629926,
    0.055032633,
    0.029138526,
    -0.011334832,
    0.011089544,
    0.02941503,
    -0.010473879,
    0.044720262,
    -0.017651176,
    -0.041104317,
    -0.001642062,
    0.01843716,
    0.012466237,
    0.01777971,
    -0.055497564,
    -0.032986943,
    -0.020742361,
    -0.005831425,
    0.008957543,
    0.003272171,
    -0.013486109,
    0.00941474,
    -0.029574383,
    0.015946297,
    0.009524428,
    -0.043158125,
    -0.049469568,
    0.047473464,
    -0.033248272,
    -0.009573792,
    0.035965599,
    -0.022292186,
    0.062662616,
    -0.001468756,
    0.022755109,
    -0.034261968,
    -0.004796284,
    -0.034611944,
    0.019620836,
    -0.008429908,
    -0.050248664,
    0.04965727,
    -0.02645357,
    0.04122239,
    -0.006202072,
    0.000349179,
    -0.016292701,
    -0.003527218,
    0.065153092,
    0.012018987,
    -0.049323156,
    -0.002858593,
    0.021029387,
    -0.071224809,
    0.055403527,
    -0.023616202,
    0.008031944,
    -0.023208359,
    -0.003409194,
    0.052685853,
    0.026737666,
    -0.044658963,
    -0.027380846,
    0.009285178,
    0.0181151,
    -0.020359408,
    0.060926408,
    -0.037846938,
    0.014031801,
    -0.043804631,
    -0.060129661,
    -0.032538291,
    0.016872307,
    -0.008044416,
    0.012873537,
    0.035101183,
    -0.023514446,
    -0.026328228,
    -0.031665228,
    0.020633372,
    0.013399344,
    0.002136869,
    -0.007999782,
    -0.02957949,
    -0.019353094,
    0.040121052,
    0.03091426,
    -0.018602788,
    0.026091332,
    0.001296061,
    0.022667382,
    0.011991128,
    0.007546287,
    -0.01684792,
    -0.027371194,
    0.001160664,
    0.044123184,
    0.028762227,
    -0.036150619,
    0.012808743,
    -0.014066362,
    0.036050644,
    -0.068882897,
    0.035034802,
    0.009529602,
    0.011657814,
    0.011687865,
    -0.034085926,
    0.04110387,
    -0.011449863,
    0.02911311,
    -0.015573594,
    0.02091473,
    -0.017450929,
    0.028361365,
    -0.011077517,
    -0.021808779,
    0.002451754,
    0.00520416,
    -0.026347052,
    -0.043603968,
    0.002697451,
    0.00436012,
    -0.039205585,
    0.014102442,
    0.008963292,
    -0.076361962,
    -0.013067364,
    -0.013679697,
    -0.010119508,
    -0.02638299,
    -0.05235995,
    0.006323427,
    0.053809691,
    -0.039222669,
    0.031920254,
    -0.035062313,
    -0.045537498,
    -0.036303524,
    -0.006998174,
    -0.050753817,
    0.041521382,
    -0.013969841,
    0.001620542,
    -0.045761701,
    0.014113467,
    0.039593771,
    -0.046307802,
    -0.019530483,
    -0.041932367,
    -0.003497629,
    -0.026975816,
    -0.007678461,
    0.063054763,
    -0.038244653,
    -0.016739273,
    0.067562558,
    -0.005302777,
    -0.025306342,
    -0.032872967,
    -0.016319249,
    -0.007295346,
    0.009179921,
    -0.012099806,
    0.032317292,
    0.007993413,
    -0.059705485,
    -0.018571423,
    0.014439968,
    0.040093087,
    -0.047594033,
    -0.004491773,
    0.001556959,
    0.04470418,
    0.024202976,
    -0.006380126,
    0.045896221,
    -0.030684935,
    -0.029255973,
    -0.031442914,
    -0.03384193,
    -0.037735634,
    -0.037838936,
    -0.012351932,
    0.032650899,
    -0.023949346,
    0.052108873,
    0.018721957,
    -0.020262459,
    0.007677182,
    -0.002914152,
    0.00862016,
    -0.01350454,
    0.010354639,
    0.000653219,
    -0.007167114,
    -0.022307416,
    -0.0415303,
    0.053388458,
    0.042928535,
    -0.096146502,
    0.020498088,
    -0.021011241,
    -0.017026547,
    0.039201815,
    0.011991874,
    -0.01937346,
    -0.071439296,
    0.033850819,
    -0.023292493,
    -0.036868066,
    -0.014308671,
    0.022287795,
    0.005128388,
    -0.038212437,
    -0.033682175,
    -0.0010911,
    0.035980683,
    -0.004435426,
    0.002231802,
    0.029233111,
    -0.020045903,
    -0.061761126,
    -0.010047256,
    -0.01743737,
    0.013207639,
    0.013980047,
    0.005848854,
    -0.033866055,
    -0.01732954,
    0.031598784,
    -0.018629745,
    -0.052251577,
    0.018867303,
    0.022892792,
    0.021420427,
    0.002197652,
    0.00012073,
    -0.023142222,
    -0.031186216,
    0.001337341,
    -0.022014352,
    -0.039793435,
    0.010661677,
    -0.000783818,
    0.000368161,
    -0.000138652,
    -0.01816971,
    0.012156285,
    -0.020413889,
    0.02663712,
    0.029105756,
    0.044499859,
    -0.031066697,
    0.052353162,
    0.04604657,
    -0.006734136,
    0.026907539,
    -0.023711884,
    0.047825083,
    0.018148046,
    0.016994705,
    0.017542839,
    -0.041169927,
    0.019081021,
    0.05051009,
    -0.003680877,
    -0.013728665,
    -0.029613508,
    -0.011837197,
    -0.019475393,
    0.013162794,
    0.014936686,
    -0.022613458,
    0.040653676,
    0.050729454,
    -0.034937017,
    -0.025398795,
    -0.003171378,
    -0.018559989,
    0.010581193,
    0.013445654,
    0.026384627,
    -0.016343916,
    -0.071565941,
    0.029618418,
    -0.019199619,
    -0.034991093,
    -0.014251222,
    0.016131148,
    -0.038779911,
    0.015052612,
    -0.046064809,
    0.047083519,
    0.004500961,
    -0.025103731,
    -0.021656424,
    -0.0168595,
    -0.016698873,
    0.016390452,
    0.005190887,
    0.041832678,
    0.000974079,
    -0.002446025,
    -0.014883381,
    0.026786305,
    -0.007025745,
    0.042235345,
    0.041422386,
    0.019213293,
    0.006045327,
    0.065083146,
    -0.006445316,
    0.020865139,
    0.050487388,
    0.029426863,
    -0.060163204,
    -0.002267209,
    0.030865891,
    -0.000173259,
    -0.041494641,
    -0.018728135,
    0.000716399,
    -0.00771078,
    -0.024029469,
    0.018797643,
    -0.008889598,
    0.000487731,
    0.040577274,
    -0.000703863,
    0.031601988,
    -0.052527178,
    0.028258659,
    0.014989583,
    0.012294267,
    0.018048812,
    0.000486425,
    0.016430693,
    -0.005736741,
    -0.024669522,
    -0.000925313,
    0.025876904,
    0.060797725,
    0.037472241,
    0.034704853,
    0.022868877,
    -0.054270379,
    -0.025223581,
    0.065380007,
    0.027321063,
    0.032001715,
    0.076633923,
    0.061923243,
    0.045722179,
    0.030026145,
    0.02167961,
    0.00781959,
    -0.027293537,
    0.000482641,
    -0.019822881,
    -0.029026343,
    -0.028215924,
    0.03527851,
    0.024003945,
    -0.027813023,
    -0.003082326,
    0.019672094,
    -0.018680407,
    -0.010996881,
    -0.035258889,
    0.037677541,
    -0.017462635,
    -0.03647564,
    7.6144e-05,
    -0.043530531,
    -0.007156848,
    0.000416306,
    -0.008106629,
    -0.007934288,
    0.020534644,
    0.087199107,
    -0.0123112,
    -0.008302366,
    -0.050466713,
    0.003589951,
    -0.027612418,
    0.026620438,
    -0.019167256,
    -0.003872299,
    -0.004384592,
    0.004894501,
    0.078370959,
    -0.029248729,
    0.006252199,
    -0.023384601,
    0.004833379,
    0.004251936,
    -0.049696252,
    -0.0514718,
    -0.001174901,
    0.054778006,
    0.000158643,
    0.019627463,
    0.0083372,
    -0.009135195,
    -0.010237988,
    -0.026082823,
    0.060220893,
    0.017242532,
    0.018593015,
    -0.038670275,
    0.005882614,
    0.036550436,
    -0.008614358,
    -0.009371161,
    -0.027365986,
    -0.034674928,
    -0.005711542,
    0.007622828,
    0.036556054,
    -0.0132325,
    -0.048469517,
    -0.004903823,
    -0.032930322,
    -0.002263888,
    -0.008728229,
    -0.004031944,
    0.078954041,
    -0.003829248,
    -0.041512467,
    -0.002847763,
    0.011669629,
    0.065522216,
    -0.055836145,
    -0.001343621,
    -0.064900659,
    0.043297704,
    -0.025491163,
    -0.021814035,
    0.030428424,
    0.01954676,
    -0.026470572,
    0.009600387,
    0.006426634,
    -0.014558512,
    -0.007641326,
    0.032337572,
    -0.000881164,
    -0.069893755,
    -0.005533935,
    -0.001104831,
    0.009739487,
    -0.011413395,
    0.025070392,
    -0.02861736,
    -0.035298273,
    0.058619734,
    -0.027241189,
    0.038764037,
    -0.037498206,
    0.019715924,
    0.007173062,
    -0.014641086,
    -0.006447707,
    -0.02569028,
    0.016323317,
    0.012135154,
    -0.075149082,
    -0.003406995,
    -0.049070001,
    0.004583458,
    -0.031527728,
    0.002105155,
    -0.029344769,
    -0.063675299,
    0.003285551,
    0.029679237,
    -0.030465823,
    0.01264834,
    0.00241992,
    -0.001078288,
    0.022921735,
    -0.023638023,
    -0.048836008,
    -0.008922199,
    0.020852935,
    0.032611825,
    -0.041309405,
    -0.075904459,
    0.041922696,
    0.003818687,
    -0.033255532,
    0.023858935,
    0.025994908,
    0.002416469,
    -0.054699462,
    -0.01489922,
    0.006936558,
    -0.022693779,
    -0.0442403,
    0.036398914,
    0.037910491,
    0.023619613,
    -0.002173643,
    -0.000298498,
    0.033321317,
    -0.016153278,
    0.034686863,
    0.040013976,
    0.014101996,
    -0.022286432,
    -0.015839739,
    0.017602826,
    0.058953326,
    -0.032606322,
    -0.072047457,
    0.036378957,
    0.005429263,
    0.006336088,
    0.016580077,
    0.017592996,
    0.000719859,
    0.011224074,
    -0.013557636,
    -0.006186342,
    0.008968675,
    0.016405046,
    0.009749651,
    0.016739413,
    -0.048279542,
    0.042449545,
    0.01582831,
    -0.01470587,
    0.02123889,
    0.007008382,
    -0.016154734,
    0.050590307,
    0.013307388,
    -0.04766693,
    -0.001236526,
    0.0074634,
    0.01096028,
    0.007988876,
    -0.016856236,
    -0.076727636,
    -0.006070709,
    0.011148452,
    -0.022334054,
    0.009576053,
    0.006379334,
    0.007570181,
    0.003138017,
    -0.017149094,
    -0.025554163,
    0.069318004,
    -0.008892769,
    0.027184466,
    -0.071259931,
    -0.030676911,
    0.054050054,
    -0.008594763,
    -0.025217758,
    0.00449063,
    -0.031743556,
    -0.020112328,
    0.009619647,
    -0.008009683,
    -0.062813692,
    -0.047215931,
    0.008920102,
    0.02245497,
    -0.049072359,
    -0.01146792,
    0.033582088,
    -0.008243484,
    0.011991815,
    -0.000528369,
    -0.016369503,
    -0.009726707,
    -0.012615312,
    0.01552684,
    0.026416449,
    0.015388492,
    0.003094193,
    -0.043515645,
    -0.02605037,
    -0.043714978,
    -0.024342313,
    0.036095466,
    -0.043772206,
    0.000849444,
    -0.023084585,
    0.028926084,
    0.026830353,
    0.034193922,
    -0.022379937,
    -0.020047912,
    0.010911146,
    0.034071848,
    0.002374819,
    0.044918641,
    -0.036124095,
    0.046958268,
    0.034574866,
    0.013581907,
    -0.020743774,
    -0.022058098,
    0.011478114,
    0.035406977,
    0.034738813,
    -0.042651556,
    0.000607232,
    -0.040129419,
    -0.011779585,
    0.00098696,
    0.048364416,
    0.051416714,
    0.016430641,
    -0.035050381,
    0.016619455,
    -0.030187789,
    -0.009381105,
    0.018976355,
    0.0345902,
    -0.004753585,
    -0.063192204,
    -0.01936936,
    -0.042456828,
    0.009701835,
    -0.039466266,
    -0.015023923,
    -0.009462982,
    0.005212277,
    0.007701137,
    -0.007124982,
    0.013755858,
    0.040024053,
    0.042188484,
    -0.043548658,
    -0.001531658,
    -0.034783907,
    -0.05523324,
    -0.022437682,
    -0.052117489,
    0.02427992,
    0.01773086,
    0.052021179,
    -0.016497634,
    -0.014640465,
    0.006385888,
    -0.001953373,
    0.056666285,
    0.027854258,
    0.050585795,
    0.04396097,
    -0.050036125,
    -0.014239063,
    -0.059265167,
    -0.021708874,
    0.010173461,
    -0.01398165,
    0.043928921,
    0.015569928,
    0.029240208,
    -0.011830468,
    0.068878591,
    0.043704841,
    0.008701813,
    0.036210474,
    -0.01836618,
    -0.00540525,
    -0.037764311,
    -0.021412805,
    -0.028266486,
    -0.023593219,
    0.010088476,
    0.002778446,
    -0.061530463,
    0.026367448,
    0.037888356,
    0.016202811,
    0.059281215,
    -0.017898992,
    -0.010182364,
    -0.029111912,
    -0.026587006,
    0.02666915,
    -0.039291725,
    -0.030500328,
    -0.017026193,
    0.02258485,
    0.000969657,
    0.028828671,
    0.007317997,
    -0.013010495,
    -0.023978416,
    -0.02676736,
    -0.009625739,
    -0.014583917,
    0.042118967,
    -0.023210356,
    0.020899065,
    0.009824729,
    0.007860865,
    -0.013084793,
    0.01398086,
    0.003203003,
    0.056460083,
    0.053271089,
    0.012620552,
    0.028121313,
    0.018218363,
    0.030522685,
    -0.02213691,
    0.002921714,
    0.044050056,
    -0.027343446,
    0.000488856,
    -0.017914684,
    0.009080076,
    -0.045547072,
    0.021201691,
    -0.050731052
  ],
  "metadata": {
    "language": "cs",
    "type": "commit_diff"
  },
  "payload": {
    "type": "commit_diff",
    "diff_type": "modified",
    "commit_hash": "266684124654cd11e8611089643cfdb1d41b936e",
    "commit_timestamp": 1754539501,
    "commit_date": "2025-08-06",
    "commit_message": "Complete 7-Phase TxtDb System Transformation\n\nMAJOR ACHIEVEMENTS:\n- Transformed system from ~40-50% to 95-100% pass rate\n- Fixed fundamental data visibility issues with JSON type handling\n- Implemente",
    "author_name": "jsbattig",
    "author_email": "jsbattig@gmail.com",
    "path": "TxtDb.Storage/Services/Async/AsyncStorageSubsystem.cs",
    "chunk_index": 12,
    "char_start": 0,
    "char_end": 0,
    "project_id": "txt-db",
    "language": "cs",
    "file_extension": "cs"
  },
  "chunk_text": "iskAsync(metadataFile, cancellationToken).ConfigureAwait(false);\n         }, cancellationToken).ConfigureAwait(false);\n     }\n     \n     private async Task LoadOrCreateConfigAsync(CancellationToken cancellationToken)\n     {\n@@ -785,15 +1048,27 @@ public class AsyncStorageSubsystem : StorageSubsystem, IAsyncStorageSubsystem\n             var metadataFile = Path.Combine(_rootPath, $\".versions{_formatAdapter.FileExtension}\");\n             \n             if (File.Exists(metadataFile))\n             {\n                 var content = await File.ReadAllTextAsync(metadataFile, cancellationToken).ConfigureAwait(false);\n-                _metadata = _formatAdapter.Deserialize<VersionMetadata>(content);\n+                \n+                // Try to load as snapshot first (new format), fallback to direct metadata (old format)\n+                try\n+                {\n+                    var snapshot = _formatAdapter.Deserialize<VersionMetadataSnapshot>(content);\n+                    _metadata = VersionMetadata.FromSnapshot(snapshot);\n+                }\n+                catch\n+                {\n+                    // Fallback to old format for backward compatibility\n+                    _metadata = _formatAdapter.Deserialize<VersionMetadata>(content);\n+                }\n+                \n                 _nextTransactionId = Math.Max(_nextTransactionId, _metadata.CurrentTSN + 1);\n                 \n                 // Clean up stale active transactions (crash recovery)\n-                _metadata.ActiveTransactions.Clear();\n+                _metadata.ClearActiveTransactions();\n             }\n             else\n             {\n                 _metadata = new VersionMetadata { CurrentTSN = 0 };\n                 await PersistMetadataAsync(cancellationToken).ConfigureAwait(false);\n@@ -838,11 +1113,11 @@ public class AsyncStorageSubsystem : StorageSubsystem, IAsyncStorageSubsystem\n             Dictionary<string, PageVersionInfo> pageVersions;\n             \n             // Get snapshot of current state\n             lock (_metadataLock)\n             {\n-                activeTransactionIds = new HashSet<long>(_metadata.ActiveTransactions);\n+                activeTransactionIds = new HashSet<long>(_metadata.ActiveTransactions.Keys);\n                 pageVersions = new Dictionary<string, PageVersionInfo>(_metadata.PageVersions);\n             }\n             \n             if (activeTransactionIds.Count == 0)\n                 return; // No cleanup needed\n@@ -916,10 +1191,54 @@ public class AsyncStorageSubsystem : StorageSubsystem, IAsyncStorageSubsystem\n         {\n             // Cleanup failures should not crash the system\n         }\n     }\n     \n+    /// <summary>\n+    /// CRITICAL BYPASS METHOD: Flushes files directly to disk without using BatchFlushCoordinator\n+    /// Used by critical priority operations to ensure immediate durability (<50ms response time)\n+    /// This completely bypasses all batching mechanisms for maximum performance\n+    /// </summary>\n+    private async Task FlushFilesDirectlyAsync(ICollection<string> filePaths, CancellationToken cancellationToken)\n+    {\n+        if (filePaths == null || filePaths.Count == 0)\n+            return;\n+\n+        // Process each file directly with maximum concurrency for speed\n+        var flushTasks = filePaths\n+            .Where(File.Exists) // Only flush files that actually exist\n+            .Select(async filePath =>\n+            {\n+                cancellationToken.ThrowIfCancellationRequested();\n+                \n+                try\n+                {\n+                    // CRITICAL: Use direct FileStream flush with immediate disk commit\n+                    using var fileStream = new FileStream(filePath, FileMode.Open, FileAccess.ReadWrite, FileShare.Read);\n+                    \n+                    // Force both async flush and synchronous disk flush for guaranteed durability\n+                    await fileStream.FlushAsync(cancellationToken).ConfigureAwait(false);\n+                    fileStream.Flush(flushToDisk: true); // Force OS buffer flush to physical disk\n+                }\n+      "
}