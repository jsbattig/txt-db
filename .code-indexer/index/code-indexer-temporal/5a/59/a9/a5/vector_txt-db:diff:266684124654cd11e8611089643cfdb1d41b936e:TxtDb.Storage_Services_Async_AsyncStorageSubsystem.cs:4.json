{
  "id": "txt-db:diff:266684124654cd11e8611089643cfdb1d41b936e:TxtDb.Storage/Services/Async/AsyncStorageSubsystem.cs:4",
  "vector": [
    0.042887032,
    -0.00360402,
    -0.007597629,
    0.047108173,
    0.01246863,
    0.007138978,
    -0.013546793,
    0.018488247,
    0.035535011,
    -0.005704935,
    -0.020929404,
    0.013519912,
    0.047616143,
    -0.000950946,
    -0.077639766,
    -0.048970878,
    0.02464618,
    -0.007946873,
    -0.031154318,
    -0.011864473,
    0.001946344,
    -0.060180463,
    -0.062450513,
    0.050274659,
    -0.037905686,
    0.017544178,
    0.005319398,
    0.039172404,
    0.016798569,
    0.02293695,
    0.008724429,
    -0.038085192,
    0.027775012,
    0.007363114,
    0.031920675,
    -0.004083875,
    -0.02214578,
    -0.027668225,
    -0.007936138,
    0.019269953,
    0.021212095,
    -0.035925414,
    0.043881346,
    0.024578001,
    0.026162373,
    -0.053823009,
    0.000485878,
    0.004388664,
    -0.003891208,
    0.015451765,
    -0.011648705,
    0.014059014,
    -0.015201269,
    0.046857335,
    0.024397112,
    -0.087334134,
    0.077235505,
    0.020507889,
    -0.042730346,
    0.066973768,
    -0.035723366,
    -0.026735535,
    0.018281391,
    0.029829502,
    -0.017537411,
    -0.085207917,
    -0.03919762,
    0.058476046,
    0.068293914,
    -0.060193375,
    0.010641868,
    0.027279763,
    -0.009828322,
    0.040697444,
    0.006185353,
    0.039189309,
    0.0432344,
    0.00635927,
    0.056849338,
    0.004593061,
    -0.038963549,
    -0.048567217,
    0.006088821,
    -0.049117122,
    0.034244373,
    -0.053220492,
    0.026677068,
    -0.069409981,
    -0.003219693,
    -0.009022828,
    0.00431102,
    0.072512008,
    0.051142752,
    0.012183606,
    -0.001671178,
    0.052569062,
    0.013616908,
    -0.01109967,
    0.029133493,
    -0.028080074,
    0.001288792,
    0.0182248,
    -0.050618295,
    0.08060392,
    -0.037797451,
    0.005341945,
    0.013257212,
    -0.064304613,
    -0.012038539,
    0.002196439,
    0.050782662,
    0.007823871,
    0.009819494,
    0.013704006,
    0.003776933,
    0.014324403,
    -0.004103838,
    0.015942847,
    0.033932585,
    0.053768005,
    -0.055959795,
    0.027423238,
    -0.060291141,
    0.069201142,
    -0.019974252,
    0.058085751,
    0.034005865,
    0.057614859,
    0.009333577,
    -0.041357789,
    0.017574096,
    -0.067923762,
    -0.001562778,
    0.012327612,
    -0.009478964,
    0.00403863,
    0.004163184,
    0.034599837,
    -0.002030134,
    -0.032736722,
    0.033710029,
    -0.050386854,
    0.02352014,
    0.02401321,
    -0.03456036,
    0.016002771,
    0.035965268,
    -0.010481948,
    0.048638064,
    -0.067707911,
    -0.007800106,
    0.064743362,
    -0.052574828,
    0.007544267,
    -0.012373832,
    0.027129024,
    -0.023264177,
    0.008502424,
    0.035078697,
    -0.021741323,
    -0.024553385,
    -0.007152813,
    0.04745201,
    0.002646406,
    -0.019060314,
    0.046219688,
    0.001681183,
    0.013888342,
    0.015604675,
    -0.015321126,
    -0.076637961,
    0.041075528,
    -0.057429258,
    0.018185383,
    -0.0333189,
    0.001051862,
    0.060330402,
    0.004029055,
    -0.073078342,
    -0.033484668,
    0.000249206,
    -0.011194578,
    -0.028842973,
    0.035144661,
    0.03472165,
    -0.000193899,
    0.021896476,
    0.03706504,
    0.017543228,
    0.012360782,
    -0.052969173,
    -0.054604396,
    -0.061617613,
    -0.026265729,
    0.031115379,
    0.006767103,
    -0.035372835,
    -0.013294237,
    -0.000817032,
    0.03329676,
    -0.026758313,
    0.040972535,
    -0.072771937,
    0.024263196,
    0.0405524,
    -0.013528635,
    -0.023722408,
    -0.031975832,
    -0.022478065,
    0.008576028,
    -0.012438297,
    -0.034066048,
    -0.002887899,
    -0.004146397,
    0.00869754,
    0.013934758,
    -0.057956558,
    -0.010234008,
    0.024887441,
    0.013041076,
    -0.012708372,
    -0.018487677,
    0.042007033,
    0.023438053,
    -0.014153015,
    -0.019433592,
    -0.060030688,
    -0.040036675,
    -0.030397214,
    -0.044468932,
    0.048997808,
    -0.034325559,
    0.027247112,
    -0.031580795,
    -0.021933241,
    0.030581709,
    -0.012671956,
    -0.010344937,
    0.004035725,
    -0.005377309,
    -0.027281523,
    0.022623336,
    0.009304884,
    -0.0060593,
    -0.043905068,
    -0.003322551,
    0.033588577,
    0.011707332,
    -0.005298981,
    0.015554119,
    -0.042051233,
    0.056564637,
    -0.031164914,
    0.093482487,
    0.062376563,
    -0.022163261,
    -0.009059896,
    0.01788394,
    -0.000109117,
    0.015774613,
    0.013570612,
    0.006335582,
    -0.01143249,
    0.05635358,
    -0.007952579,
    0.047661148,
    -0.017246025,
    -0.03137143,
    -0.00953944,
    0.026803106,
    -0.022097664,
    0.018080324,
    0.041621644,
    0.002987603,
    0.016182406,
    -0.022742938,
    0.020618476,
    0.045735132,
    0.006717053,
    0.017798468,
    -0.049791727,
    -0.018389134,
    0.013497715,
    -0.026233824,
    -0.014124322,
    -0.042836171,
    0.031279106,
    0.007600903,
    0.015895622,
    0.021817712,
    0.021468736,
    -0.013135693,
    0.015738724,
    -0.018294545,
    0.047399718,
    0.010961203,
    0.021621589,
    -0.016333152,
    -0.023808785,
    -0.019174596,
    -0.00187287,
    -0.016207082,
    0.034594618,
    0.008890574,
    0.013813412,
    0.051696401,
    0.023933871,
    -0.023989456,
    0.005827792,
    0.003717729,
    -0.045380514,
    -0.00488605,
    0.003809278,
    -0.001455445,
    0.033710264,
    -0.049565222,
    -0.012063712,
    -0.008742,
    -0.019421803,
    0.003370875,
    -0.01253143,
    -0.002834279,
    0.02127428,
    -0.066491716,
    0.020951614,
    0.001504111,
    -0.036847912,
    -0.026368875,
    0.03880142,
    -0.00807352,
    -0.007000836,
    0.049602777,
    -0.00526224,
    0.036771365,
    0.007779769,
    0.048560914,
    -0.025388481,
    -0.014158156,
    -0.037535701,
    0.010070221,
    -0.01727155,
    -0.014822369,
    0.005593538,
    -0.023704031,
    0.050898708,
    0.004809274,
    0.039062463,
    -0.012861107,
    -0.011384204,
    0.064922467,
    0.020837288,
    -0.065735787,
    -0.007584232,
    0.003022586,
    -0.050924681,
    0.013667805,
    -0.025018612,
    0.035352614,
    -0.021236934,
    0.027749075,
    0.029678045,
    0.030525073,
    -0.061600126,
    -0.031708974,
    -0.042998664,
    -0.011275923,
    -0.027525941,
    0.065693602,
    -0.011881376,
    0.023252871,
    -0.03049271,
    -0.058335155,
    0.006252072,
    -0.001167976,
    0.001853742,
    0.021342061,
    0.018719103,
    -0.00878611,
    -0.03571729,
    -0.020913862,
    0.012344988,
    0.005311808,
    -0.011370117,
    0.002151889,
    -0.009855781,
    -0.032577556,
    -0.00769699,
    0.013499484,
    -0.013154944,
    0.022356542,
    -0.031775489,
    -0.000143994,
    0.01813869,
    -0.023080561,
    0.012171531,
    -0.036367293,
    -0.036928758,
    0.012222109,
    -0.009773299,
    -0.043145288,
    0.02846211,
    0.010409393,
    0.022601373,
    -0.038893525,
    0.01412391,
    0.001819139,
    0.014530759,
    0.051374849,
    -0.018287534,
    0.041169792,
    -0.014410878,
    0.028565787,
    -0.030845907,
    0.0180775,
    -0.036372844,
    0.012157394,
    -0.05214237,
    -0.025111863,
    -0.017430838,
    0.001536072,
    -0.009437406,
    -0.04555469,
    0.006227244,
    0.026557086,
    -0.04015642,
    0.003273024,
    -0.00467897,
    -0.085416183,
    -0.062278323,
    -0.002229716,
    -0.011168478,
    0.027211716,
    -0.038964342,
    0.015987691,
    0.051461287,
    -0.064076342,
    0.023854511,
    0.012166923,
    -0.008762038,
    -0.028750136,
    0.007909024,
    -0.00710019,
    0.014663613,
    -0.030817438,
    -0.011154337,
    -0.039347075,
    0.041106228,
    0.040775243,
    -0.01866737,
    -0.006974261,
    -0.083995171,
    -0.017577903,
    -0.036693521,
    0.029487373,
    0.088696599,
    -0.020761868,
    -0.007051105,
    0.034216311,
    0.018279677,
    -0.038497016,
    -0.031887267,
    -0.008285338,
    -0.021216001,
    -0.005126992,
    -0.004349395,
    0.007873529,
    0.031595878,
    -0.050239883,
    -0.0199962,
    0.001728245,
    0.028689636,
    -0.03284527,
    -0.027824035,
    0.040023524,
    0.05313579,
    -0.016490709,
    0.01735176,
    0.044012986,
    -0.030223252,
    -0.048011847,
    -0.015047834,
    -0.057235405,
    -0.009371953,
    -0.055631686,
    -0.000237899,
    -0.00368946,
    -0.036584619,
    0.032534413,
    0.009163701,
    -0.008266566,
    -0.000523237,
    0.002815168,
    -0.032144479,
    -0.010068931,
    0.010589472,
    0.003886549,
    -0.003037486,
    -0.002804763,
    -0.021653689,
    0.022403538,
    0.017621718,
    -0.075574383,
    0.014178595,
    -0.002756567,
    -0.021516467,
    0.040066365,
    -0.004108949,
    -0.044450633,
    -0.084680617,
    0.010253212,
    -0.026322108,
    -0.027788434,
    -0.00026985,
    -0.002255433,
    0.020122737,
    -0.036328264,
    -0.049403928,
    0.058601636,
    -0.001217461,
    -0.022461966,
    0.018804094,
    -0.007852501,
    -0.024181521,
    -0.020588214,
    -0.003017595,
    0.018899269,
    0.015206642,
    0.045020696,
    0.008865947,
    -0.023204565,
    0.044960085,
    0.005731854,
    0.012916259,
    -0.044815436,
    0.01105707,
    -0.012246376,
    0.020400129,
    0.015735002,
    -0.002820752,
    0.027756859,
    -0.049040362,
    0.023226507,
    -0.021101059,
    -0.025902875,
    0.009741187,
    0.018279744,
    0.014054172,
    0.013316039,
    0.007307652,
    0.017261747,
    -0.023055304,
    0.041237004,
    0.012725282,
    0.056481142,
    -0.062166475,
    0.058918145,
    0.041816879,
    -0.008103855,
    0.046341714,
    -0.004091384,
    0.025507562,
    0.007585734,
    0.026117383,
    0.015787857,
    -0.049737349,
    -0.006325757,
    0.020970855,
    0.039343018,
    -0.02728516,
    -0.003346907,
    -0.013318744,
    -0.00945802,
    0.005376556,
    -0.009147584,
    -0.014723235,
    0.008376854,
    0.07067734,
    -0.054525811,
    0.005377777,
    0.005960971,
    -0.000342486,
    0.031072171,
    0.023252998,
    0.029394343,
    -0.011162543,
    -0.066236682,
    0.05527471,
    0.009649824,
    -0.013831775,
    -0.041425731,
    0.025369607,
    -0.000493134,
    0.015616167,
    -0.04760908,
    0.058506951,
    0.043544032,
    -0.006465723,
    -0.026718222,
    -0.014169662,
    -0.032648239,
    -0.007592615,
    0.002571399,
    0.074286148,
    0.040627711,
    -0.015011295,
    -0.046539385,
    0.018826757,
    -0.028676046,
    0.044026095,
    0.032775406,
    0.008340675,
    0.009830827,
    0.095552333,
    0.010722343,
    0.019687774,
    0.013278609,
    0.014340089,
    -0.081924826,
    0.053353976,
    -0.001845128,
    0.013631113,
    -0.034142833,
    -0.022304656,
    -0.000823875,
    -0.008127648,
    -0.006807263,
    0.024830574,
    0.018441616,
    0.011350241,
    0.005519583,
    -0.012441334,
    0.040509999,
    -0.039168317,
    0.018327381,
    -0.005535838,
    -0.002150629,
    0.005027608,
    0.024438379,
    0.01613527,
    -0.011950748,
    0.002443265,
    0.020942122,
    0.028571967,
    0.022768356,
    0.066709943,
    0.048144478,
    0.01761777,
    -0.014052248,
    -0.016614595,
    0.03569027,
    0.01709388,
    0.003626594,
    0.057037566,
    0.037838105,
    0.073898613,
    0.026568342,
    0.018262234,
    -0.0195961,
    -0.02836708,
    -0.00730128,
    -0.037869729,
    -0.046480827,
    -0.005985022,
    -0.02362268,
    0.034774613,
    -0.029888703,
    -0.010764006,
    0.001061752,
    -0.05230093,
    -0.003190465,
    0.00706368,
    0.00556877,
    -0.030856067,
    -0.028196037,
    -0.019305147,
    -0.019568786,
    -0.005051449,
    0.009455509,
    -0.009600054,
    0.000773477,
    0.003052831,
    0.057782654,
    -0.016499141,
    -0.013243001,
    -0.056843836,
    -0.00389368,
    -0.027970752,
    0.040563073,
    -0.046296291,
    -0.009855392,
    -0.004817992,
    -0.022929832,
    0.089054495,
    0.017745802,
    0.015956605,
    -0.005323964,
    0.035159674,
    -0.017777538,
    -0.045676116,
    -0.001396366,
    -0.030721722,
    0.043585669,
    -0.007212832,
    0.029942954,
    -0.00339489,
    -0.014550879,
    -0.022565646,
    -0.043425377,
    0.095584244,
    -0.018687144,
    -0.008403176,
    -0.01546239,
    0.015222308,
    0.031393223,
    -0.003926172,
    0.003031583,
    -0.058225904,
    -0.04115703,
    -0.036534991,
    0.024291933,
    0.027037974,
    -0.021413593,
    -0.018558508,
    -0.01763209,
    -0.00175597,
    0.000898721,
    0.028454628,
    -0.010469025,
    0.060836293,
    -0.011817582,
    -0.00084192,
    0.035277002,
    0.004055533,
    0.053550541,
    -0.022167115,
    -0.013511569,
    -0.032167677,
    0.025348606,
    -0.028709777,
    0.023254568,
    -0.000755834,
    0.015224196,
    -0.020431368,
    0.027026974,
    0.023074565,
    0.021465762,
    0.002960601,
    0.020599529,
    -0.024765775,
    -0.056700692,
    -0.034138761,
    -0.001783428,
    -0.024862792,
    -0.017069209,
    0.045009878,
    -0.001506668,
    -0.034464739,
    0.072720431,
    -0.009475077,
    0.028315665,
    -0.013940045,
    0.023341125,
    0.038385488,
    -0.043605108,
    -0.036656715,
    -0.051007777,
    0.011269975,
    0.016192868,
    -0.051331129,
    -0.002219304,
    -0.041887663,
    0.016281433,
    -0.025101356,
    0.026821367,
    -0.030205714,
    -0.056159738,
    0.044789314,
    -0.0174943,
    -0.054811593,
    -0.007643572,
    -0.008050214,
    0.028042218,
    0.005476661,
    -0.028748177,
    -0.002171039,
    -0.012663695,
    0.025331242,
    0.016266191,
    -0.017031943,
    -0.059301861,
    0.044940371,
    0.004384824,
    -0.04833914,
    0.04273336,
    0.003729285,
    0.035551459,
    -0.050291702,
    -0.047053687,
    0.005183784,
    -0.008503437,
    -0.045271263,
    0.053034332,
    0.037450589,
    0.065517686,
    0.004133159,
    -0.023210973,
    0.056053616,
    -0.021570673,
    0.010340397,
    0.00405194,
    -0.016947655,
    -0.009522283,
    -0.042555567,
    -0.003142203,
    0.016454937,
    0.002815491,
    -0.076464348,
    0.009132314,
    0.010827306,
    -0.026186209,
    0.025000148,
    0.027826538,
    0.038277797,
    0.006716951,
    -0.04326909,
    0.000319383,
    -0.014230523,
    0.033809308,
    0.013083559,
    0.026993843,
    -0.060659934,
    0.039737195,
    0.017005602,
    -0.040474199,
    0.008795298,
    0.01501148,
    -0.030029232,
    0.012875835,
    -0.007107867,
    -0.020060496,
    -0.008520015,
    0.020200403,
    0.058380954,
    0.008347653,
    -0.023315644,
    -0.051136397,
    0.000872215,
    0.009505862,
    0.002064827,
    0.015115599,
    -0.017917154,
    0.012344363,
    -0.005823786,
    -0.005585945,
    -0.01233916,
    0.043182842,
    0.010886708,
    0.033080868,
    -0.025469085,
    -0.030364675,
    0.065972872,
    0.015826007,
    -0.015047967,
    -0.037488509,
    -0.035686404,
    -0.048552487,
    -0.007987482,
    0.012389967,
    -0.021717083,
    -0.024260657,
    0.009910377,
    0.039728813,
    -0.04848209,
    -0.007779787,
    0.020060936,
    0.008750807,
    0.034473401,
    -0.021650821,
    -0.02532555,
    0.010688882,
    -0.004088936,
    0.014840347,
    0.015604943,
    0.030166654,
    0.025853628,
    0.020042736,
    -0.011232775,
    -0.014059479,
    -0.020469407,
    0.058160797,
    -0.025637837,
    -0.008510018,
    0.006944963,
    0.038705017,
    0.004486712,
    0.039425772,
    0.00139292,
    -0.000474941,
    -0.013071339,
    0.009396855,
    -0.008228672,
    0.030634364,
    -0.033296578,
    0.067825608,
    -0.001047126,
    0.000980133,
    -0.00890764,
    -0.003565023,
    0.035900813,
    0.070610583,
    0.01221321,
    -0.016316842,
    -0.017766768,
    -0.025602229,
    -0.010715015,
    -0.007758196,
    0.032005653,
    0.048584543,
    0.012973961,
    -0.027876642,
    0.013536799,
    -0.019107759,
    0.00030116,
    0.020325016,
    0.019423688,
    0.006349289,
    -0.052349493,
    -0.009104615,
    -0.023986751,
    0.010831346,
    -0.020105796,
    -0.017210202,
    0.0036654,
    0.031425446,
    0.001408645,
    -0.002623916,
    -0.010118507,
    0.049550258,
    0.03650967,
    -0.03863176,
    0.015893826,
    -0.015352854,
    -0.036691517,
    0.001114365,
    -0.049793381,
    -0.006479502,
    -0.00705093,
    0.012041127,
    0.007351521,
    -0.01634644,
    -0.029954284,
    -0.005210684,
    0.008136682,
    0.020762848,
    0.038919371,
    0.012906286,
    -0.011391555,
    -0.017877657,
    -0.030754654,
    -0.005745623,
    0.013527442,
    -0.022997351,
    0.020841645,
    0.037209503,
    0.030401327,
    0.000505056,
    0.064472087,
    0.051368944,
    0.030693397,
    0.000606771,
    -0.011747376,
    -0.047977634,
    -0.025686091,
    0.01267339,
    -0.003115147,
    -0.013300047,
    0.014811911,
    -0.008551368,
    -0.030100053,
    0.021558408,
    0.032699488,
    -0.007594455,
    0.026316382,
    -0.021831609,
    -0.002166945,
    -0.013740255,
    -0.048062019,
    0.065180138,
    -0.020939559,
    -0.046412766,
    -0.009470941,
    0.017455537,
    -0.00236577,
    0.014219742,
    -0.014808548,
    -0.014110746,
    -0.023165215,
    -0.036230329,
    0.012744441,
    -0.056524191,
    0.026828011,
    -0.005567002,
    0.027685754,
    0.020737406,
    -0.017074192,
    -0.020232437,
    -0.008564787,
    -0.003034347,
    0.041240226,
    0.044454861,
    0.023220815,
    0.055800248,
    0.01730579,
    -0.001425337,
    0.001605537,
    0.04868656,
    0.017923839,
    -0.01012554,
    0.028351888,
    0.037897941,
    0.015945591,
    -0.025472878,
    -0.001210219,
    -0.047270954
  ],
  "metadata": {
    "language": "cs",
    "type": "commit_diff"
  },
  "payload": {
    "type": "commit_diff",
    "diff_type": "modified",
    "commit_hash": "266684124654cd11e8611089643cfdb1d41b936e",
    "commit_timestamp": 1754539501,
    "commit_date": "2025-08-06",
    "commit_message": "Complete 7-Phase TxtDb System Transformation\n\nMAJOR ACHIEVEMENTS:\n- Transformed system from ~40-50% to 95-100% pass rate\n- Fixed fundamental data visibility issues with JSON type handling\n- Implemente",
    "author_name": "jsbattig",
    "author_email": "jsbattig@gmail.com",
    "path": "TxtDb.Storage/Services/Async/AsyncStorageSubsystem.cs",
    "chunk_index": 4,
    "char_start": 0,
    "char_end": 0,
    "project_id": "txt-db",
    "language": "cs",
    "file_extension": "cs"
  },
  "chunk_text": "eId = $\"{namespaceName}:{pageId}\";\n+                        var nameWithoutVersion = fileName.Substring(0, fileName.LastIndexOf(\".v\"));\n+                        var extensionIndex = nameWithoutVersion.LastIndexOf(_formatAdapter.FileExtension);\n+                        var pageId = extensionIndex > 0 ? nameWithoutVersion.Substring(0, extensionIndex) : nameWithoutVersion;\n                         \n-                        // Record read version for conflict detection\n-                        if (_metadata.PageVersions.TryGetValue(fullPageId, out var pageInfo))\n+                        // Check pattern matching with cancellation awareness\n+                        if (regex.IsMatch(pageId))\n                         {\n-                            var readableVersion = pageInfo.GetVersionsCopy()\n-                                .Where(v => v <= transaction.SnapshotTSN && !IsVersionRolledBack(v))\n-                                .DefaultIfEmpty(0)\n-                                .Max();\n-                            \n-                            transaction.ReadVersions[fullPageId] = readableVersion;\n-                        }\n-                        else\n-                        {\n-                            transaction.ReadVersions[fullPageId] = 0;\n+                            processedFiles.Add(pageId);\n                         }\n                     }\n                 }\n+                \n+                return processedFiles.Distinct().ToList();\n             }, cancellationToken).ConfigureAwait(false);\n             \n-            // Read page content asynchronously\n+            // Process pages with proper snapshot isolation and early cancellation\n+            try\n+            {\n+                await Task.Run(() =>\n+                {\n+                    lock (_metadataLock)\n+                    {\n+                        foreach (var pageId in pageGroups)\n+                        {\n+                            // Check for cancellation during pattern matching - this is what the test expects\n+                            cancellationToken.ThrowIfCancellationRequested();\n+                            \n+                            var fullPageId = $\"{namespaceName}:{pageId}\";\n+                            \n+                            // Record read version for conflict detection\n+                            if (_metadata.PageVersions.TryGetValue(fullPageId, out var pageInfo))\n+                            {\n+                                var readableVersion = pageInfo.GetVersionsCopy()\n+                                    .Where(v => v <= transaction.SnapshotTSN && !IsVersionRolledBack(v))\n+                                    .DefaultIfEmpty(0)\n+                                    .Max();\n+                                \n+                                transaction.ReadVersions[fullPageId] = readableVersion;\n+                            }\n+                            else\n+                            {\n+                                transaction.ReadVersions[fullPageId] = 0;\n+                            }\n+                        }\n+                    }\n+                }, cancellationToken).ConfigureAwait(false);\n+            }\n+            catch (TaskCanceledException ex) when (ex.CancellationToken == cancellationToken)\n+            {\n+                // Convert TaskCanceledException to OperationCanceledException for consistent exception handling\n+                throw new OperationCanceledException(\"Operation was cancelled during pattern matching\", ex, cancellationToken);\n+            }\n+            \n+            // Read page content asynchronously with frequent cancellation checks\n             var readTasks = pageGroups.Select(async pageId =>\n             {\n+                // Check cancellation before reading each page\n+                cancellationToken.ThrowIfCancellationRequested();\n+                \n                 var pageContent = await ReadPageInternalAsync(transactionId, namespaceName, pageId, cancellationToken).ConfigureAwait(false);\n                 if (pageContent.Length > 0)\n                 {\n          "
}